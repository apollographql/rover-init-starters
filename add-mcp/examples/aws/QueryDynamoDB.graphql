# ☁️ Let Claude query your DynamoDB data
#
# What Claude can do with this:
# - "Show me all submissions from user john@example.com"
# - "How many pending submissions does user X have?"
# - "Get recent activity for this user"
# - "Find incomplete submissions from last week"
#
# To customize for your data:
# ✏️ Replace "YOUR_TABLE_NAME" with your actual DynamoDB table
# ✏️ Update field names to match your table schema
# ✏️ Ensure your AWS credentials are configured in your environment

query QueryUserData($userId: String!) {
  """
  Let Claude search and retrieve user data from your DynamoDB table.
  
  Claude will use this when you ask about specific users, their activity,
  submissions, or any user-related data you store.
  """
  getUserData(userId: $userId) @connect(
    source: "aws"
    http: {
      POST: "https://dynamodb.us-east-1.amazonaws.com/"
      headers: [{
        name: "Content-Type"
        value: "application/x-amz-json-1.0"
      }, {
        name: "X-Amz-Target"
        value: "DynamoDB_20120810.Query"
      }]
    }
    selection: """
      TableName: "YOUR_TABLE_NAME"
      KeyConditionExpression: "userId = :userId"
      ExpressionAttributeValues: {
        ":userId": { S: {$args.userId} }
      }
    """
  ) {
    items {
      submissionId    # Unique submission identifier
      title          # Submission title or name
      status         # Current status (pending, complete, etc.)
      createdAt      # Timestamp when created
      # ✏️ Add fields from your table: description, priority, tags, etc.
      # ✏️ Update the selection mapping above to include additional DynamoDB attributes
    }
    count           # Total number of items returned
  }
}